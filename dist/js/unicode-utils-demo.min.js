/*! unicode-utils-js 12-12-2014 */
define(function(){function a(a,b){var c='<div class="utf-8">',d=a.codeToUtf8Bytes(b),e=8;switch(d.length){case 2:e=5;break;case 3:e=4;break;case 4:e=3}for(var f in d){var g=d[f],h=6;0===f&&(h=e);for(var i=g.toString(2);i.length<8;)i="0"+i,h-=1;i=i.substr(0,8-h)+'<span class="utf-8-byte-significant">'+i.substr(8-h),c+='<div class="utf-8-byte">',c+=g.toString(16).toUpperCase()+" "+i,c+='</div class="utf-8-byte">'}return c+="</div>"}function b(){var a='<div id="sequences-left-heading">';return a+='<div class="character-heading">',a+='<div class="character-label">Character</div>',a+='<div class="composite-character">Composite</div>',a+='<div class="individual-character">Individual</div>',a+='<div class="code-point-value">Code Point</div>',a+="</div>",a+='<div class="representations-heading">',a+='<div class="representations-label">Encodings</div>',a+='<div class="utf-16">UTF-16</div>',a+='<div class="utf-8">UTF-8</div>',a+="</div>"}function c(b,c){var d='<div class="sequence" data-str="'+c.string+'">';d+='<div class="composite-character">',d+=c.string,d+="</div>";for(var e in c.codePoints){var f=c.codePoints[e];d+='<div class="code-point">',d+='<div class="individual-character">',d+=f.string,d+="</div>",d+='<div class="code-point-value">',d+=b.codeToHexString("U+",f.value),d+="</div>",d+='<div class="utf-16">',d+=b.strToHexString("\\u",f.string),d+="</div>",d+=a(b,f.value),d+="</div>"}return d+="</div>"}return{analyzeString:function(a,d,e,f){function g(){f.width(9*k+.1*j+10+"em")}var h,i,j=0,k=0,l=a.strToSequences(a.strToCodePoints(d));e.html("");for(h in l)e.append(l[h].string);var m=f.find("#sequences-left-heading"),n=f.find("#sequences");m.length&&!l.length?m.attr("data-remove",!0):!m.length&&l.length&&n.before(b());var o=n.find(".sequence");for(h=0,i=0;h<l.length;h++,i++){var p=l[h],q=p.string;j+=1,k+=p.codePoints.length;var r=o.eq(i),s=r.data("str");s!=q&&(i>=o.length?n.append(c(a,p)):h<l.length-1&&s==l[h+1].string?(r.before(c(a,p)),i--):(r.attr("data-remove",!0),j-=1,k-=p.codePoints.length,h--))}o.slice(i).attr("data-remove",!0);var t=f.find('[data-remove="true"]');t.length?t.animate({opacity:0},200,function(){t.remove(),g()}):g();var u=f.parent(),v=f.width()-u.width();0>v&&(v=0),v!=u.scrollLeft()&&u.animate({scrollLeft:v},100)},analyzeCode:function(a,b,c,d){for(var e="",f=new RegExp("\\s*\\\\u([0-9|a-f|A-F]+)|\\s*U\\+([0-9|a-f|A-F]+)|\\s*0x([0-9|a-f|A-F]+)|\\s*([0-9]+)"),g=b.match(f);g;){var h;if(g[1])h=parseInt("0x"+g[1]);else if(g[2])h=parseInt("0x"+g[2]);else if(g[3])h=parseInt("0x"+g[3]);else{if(!g[4])break;h=parseInt(g[4])}if(isNaN(h))break;e+=g[1]?String.fromCharCode(h):a.codeToUtf16String(h),b=b.substr(g[0].length),g=b.match(f)}this.analyzeString(a,e,c,d)},initDemo:function(a,b,c){function d(){var c=a("#character-input").val();a("#character-checkbox").is(":checked")?f.analyzeCode(b,c,a("#output-echo-scroll"),a("#output-breakdown")):f.analyzeString(b,c,a("#output-echo-scroll"),a("#output-breakdown"))}var e="/dist/unicode-utils-js/dist/css/demo.css";c.createStyleSheet?c.createStyleSheet(e):a("head").append(a("<link rel='stylesheet' href='"+e+"' type='text/css' media='screen' />")),a("#demo").html('                     <div id="demo-container">                         <div id="character-entry">                             <strong>Input</strong>: <input id="character-input" type="text"  placeholder="type some emojis!">                             <input id="character-checkbox" type="checkbox">Numeric</input>                         </div>                         <div id="output-echo">                             <strong>Echo</strong>: <div id="output-echo-scroll" />                         </div>                         <div id="output-breakdown-scroll">                             <strong>Breakdown</strong>:                             <div id="output-breakdown">                                 <div id="sequences" />                             </div>                         </div>                     </div>                 ');var f=this;a("#character-input").bind("change input keyup",d),a("#character-checkbox").bind("change input keyup",d)}}});